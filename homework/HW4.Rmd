---
title: Assignment 4
author: "Melissa Wong"
date: \today
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r libraries, results='hide', message=FALSE, warning=FALSE}

library(tidyverse)
library(RColorBrewer)
library(rethinking)
```

```{r options}
options("scipen" = 1, "digits" = 4)

#knitr::opts_chunk$set(echo = FALSE)
#knitr::opts_chunk$set(message = FALSE)
#knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(out.width = "50%")
knitr::opts_chunk$set(fig.align = "center")

# Set Default ggplot palette
options(ggplot2.discrete.color=brewer.pal(8, "Dark2"))
options(ggplot2.discrete.fill=brewer.pal(8, "Dark2"))
```

# Problem 1

```{r}
birds <- tibble(speciesA = c(0.2, 0.8, 0.05),
                speciesB = c(0.2, 0.1, 0.15),
                speciesC = c(0.2, 0.05, 0.7),
                speciesD = c(0.2, 0.025, 0.05),
                speciesE = c(0.2, 0.025, 0.05))

# Compute entropy
apply(birds, 1, function(x) -sum(x * log(x)))
```

Island 1 has the greatest entropy; this is consistent with the fact that all species are equally probable which is the least surprising distribution is absence of any prior information.

On the other hand, Island 2 has the least entropy, which is consistent with one species (A in this case) being far more likely than the other species.

Island 3's entropy is slightly larger than Island 2 because while one species (C) is more likely than the others, the probabilities are slightly more diffuse than Island 2.

```{r}

for (row in 1:3)
{
  print(paste("target = Island", row))
  p <- birds[row]
  q <- birds[-row,]
  print(apply(q, 1, function(x) sum(p * log(p) - p * log(x))))
}
```

The KL divergence is smallest (best prediction) when the target = Island 2 and the model = Island 1.

The KL divergence is largest (worst prediction) when target = Island 3 and model = Island 2.  

# Problem 2

```{r}
df <- sim_happiness(seed=1377, N_years=1000) %>% 
  filter(age > 17) %>% 
  mutate(A = (age - 18)/(65-18),
         mid = married + 1)
summary(df)

m6.9 <- quap(
  alist(
    happiness ~ dnorm(mu, sigma),
    mu <- a[mid] + bA * A,
    a[mid] ~ dnorm(0, 1),
    bA ~ dnorm(0, 2),
    sigma ~ dexp(1)
  ), data=df
)
precis(m6.9, depth=2)

m6.10 <- quap(
  alist(
    happiness ~ dnorm(mu, sigma),
    mu <- a + bA * A,
    a ~ dnorm(0, 1),
    bA ~ dnorm(0, 2),
    sigma ~ dexp(1)
  ), data=df
)
precis(m6.10, depth=2)
```

```{r}
compare(m6.9, m6.10)
```

# Problem 3

```{r}

```




