---
title: "Chapter 6"
author: "Melissa Wong"
date: \today
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r results='hide', message=FALSE, warning=FALSE}
options("scipen" = 1, "digits" = 4)

library(tidyverse)
library(rethinking)
library(dagitty)
library(brms)
options(mc.cores = parallel::detectCores())
rstan_options(auto_write = TRUE)
```

# Practice Problems

## 6E1

1. Multicollinearity
2. Collider Bias
3. (Unobserved) Confounders

## 6E2

Simpson's Paradox is an example of confounder bias. Example is gender and college admissions.

```{r echo=FALSE}
d1 <- dagitty('dag{ 
  gender -> dept
  gender -> admitted <- dept
}')

plot(graphLayout(d1))
```

Berkson's paradox is an example of collider bias.

## 6E3

1. Fork: X <- Z -> Y (X is not a causal factor for Y but rather is correlated through Z)

2. Pipe: X -> Z -> (X is an indirect causal factor for Y)

3. Collider: X -> Z <- Y (X is not associated with Y unless conditioning on Z)

4. Descendant: X -> Z <- Y and Z -> D (X is not associated with Y unless conditioning on D)

## 6M1

```{r}
dag_6M1 <- dagitty("dag{ 
                  U [unobserved]
                  V [unobserved]
                  X -> Y
                  X <- U <- A -> C -> Y
                  U -> B <- C
                  C <- V -> Y
}")

plot(graphLayout(dag_6M1))
```

There are 5 paths from X to Y:

X - Y (open)

X - U - B - C - Y (closed because of B)

X - U - B - C - V - Y (closed because of B)

X - U - A - C - Y (open)

X - U - A _ C - V - Y (open)

We need to close the last two paths by conditioning on A.

```{r}
# Confirm
adjustmentSets(dag_6M1, exposure="X", outcome="Y")
```







